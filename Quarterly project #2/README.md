## Моделирование процесса обогащения золотоносной руды

### Стек инструментов

Глубокая предобработка данных: соединение нескольких таблиц, заполнение пропусков, поиск выбросов и аномалий;  
Создание метрики SMAPE и применение ее в валидации моделей;  
Визуализация исходных данных, библиотеки matplotlib и seaborn;
Тестирование моделей библиотеки sklearn.

### Вводные данные

Горнодобывающая компания разрабатывает предиктивную модель обогащения руды. Алгоритм рассчитывает выход золота из сырья. 
Модель позволяет принимать на вход только богатое сырье на основании небольших проб.

### Цель проекта

Создать модель, предсказывающую содержание драгоценных металлов и шлака на различных этапах обогащения.

### Структура проекта  


1.Подготовьте данные  
    1.1. Открыть и изучить данные;  
    1.2. Проверить правильность предварительных рассчетов;    
    1.3. Проанализировать признаки исходных данных;  
    1.4. Предобработать данные.  
2. Исследовательский анализ данных  
    2.1. Изучить изменение концентрации металлов (Au, Ag, Pb) на различных этапах очистки;  
    2.2. Сравнить распределения размеров гранул сырья на обучающей и тестовой выборках;  
    2.3. Исследовать суммарную концентрацию веществ. Выделить и удалить аномалии.   
3. Обучить и построить модели машинного обучения  
    3.1. Написать функцию для вычисления итоговой sMAPE;  
    3.2. Протестировать различные модели и выбрать лучшую по качеству и времени работы.  
    
### Общий вывод  

Целью настоящего проекто было составление модели для прогнозирования метрики sMAPE - симметричного среднего абсолютного процентного отклонения.

В третьем шаге была успешно создана и апробирована модель ближайших соседей, готовая для ввода в экслуатаци.

Задачами проекта являлись следующие пункты: 

Подготовка данных:
На данном этапе были обработаны пропущенные значения и удалены неизвестные таргеты с целью последующего постоения моделей. Потери данных составили ~16%, много, но других вариантов восстановить таргеты правильно выявлено не было.  

Исследовательский анализ данных:
Замечены следующие закономерности - концентрация золота на всех этапах обогащения растет, в сумме возрастает в 4 раза с 8 до 42 пунктов, концентрация свинца растет в 2,5 раза, концетрация серебра падает в 2 раза.  
Общая концентрация металлов в растворе показывает серьезный рост после флотации, однако на последующей очистке не растет.  
На данном этапе были отброшены, вероятно, аномальные значение концентрации. Потери данных составили 1%.  

Построить и обучить модель:  
Протестировано 3 модели - регрессия, случайный лес и ближайшие соседи.   

На тестовой выборке финальная модель показала значение sMAPE = 10,17, что является допустимым уровнем в данном проекте.




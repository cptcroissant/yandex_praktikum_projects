## Прогнозирование количества заказов такси в определенный час

### Стек инструментов

Обработка временных рядов, библиотека statsmodels;  
Анализ глобального тренда, сезонности, суточных и часовых паттернов;  
feature engeneering: разбивка даты на составляющие, введение лагов и скользящего среднего;  
Модели sklearn и градиентного бустинга - CatBoost, LightGBM;  
Подбор гиперпараметров модели с помощью hyperopt.

### Вводные данные

Аггрегатор такси анализирует паттерны в ежедневных заказах для привлечения большего количества водителей в пиковые часы.

Имеются размеченные данные: количество заказов в каждый час на протяжении нескольких месяцев.

### Цель

Построить модель для прогноза количества заказов на каждый час. Время предсказания и метрика RMSE должны быть минимальными.

### Структура проекта  

1. Загрузка данные и ресемплирование по одному часу;  
2. Анализ данных: тренды, сезонность, тип данных, поиск аномалий;  
3. Обучение и валидация моделей; 
4. Проверка моделей на тестовой выборке и составление выводов.  

### Общий вывод  

Целью настоящего исследования ставилось создание модели, способной предсказать спрос на услуги такси с отклонением до 48 заказов в час.  

Результатом тестовых испытаний стали 2 модели, прошедшие установленный порог - catboost и gradietboosting, c показателями 43,72 и 45,65б соответственно.  

Также в ходе исследования были протестированы 3 модели - логистическая регрессия, ближайшие соседи и регрессия с опорными векторами, однако ни одна из них не смогла пересечь рубеж в 48 rmse на тестовой выборке.  

Отчасти это связано с тем, что в тестовом сепле мы можем наблюдать повышенную дисперсию и общий тренд на увеличение заказов, которые сложно прогноризуются в "начале" сезона. Отчасти именно с этим и связано решение на шаге 4 - обучать модели на максимально полных данных, соединив обучающую и валидационную выборки.  

В остальном - данные так же показывают заметную сезонность-  пиковые нагрузки приходятся на 00 и 16-17 часов, тогда как минимальное количество заказов поступает ранним утром (6-7 часов) и в 18 часов вечера.  На основании этих данных можно создать рекомендацию о дополнительном увеличении количества экипажей такси именно в эти часы.  

Цели и задачи исследования достигнуты, однако для улучшения метрики стоит взять больший период времени или найти дополнительные фичи (вопрос к тимлиду и более опытным коллегам).


**PS**   
После глубокого погружения в тему удалось снизить RMSE до 17 путем добавления новых фич.
